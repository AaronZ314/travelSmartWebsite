<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>travelSmart Survey</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .survey-list { margin-top: 2em; }
    .survey-entry { background: #f3f6ff; border: 1px solid #c6dbf7; padding: 1em; margin-bottom: 1em; border-radius: 0.3em; }
    .survey-results { margin-top: 1em; background: #e8f0fe; border: 1px solid #c6dbf7; padding: 1em; border-radius: 0.3em; }
    .actions { margin: 1em 0; }
  </style>
</head>
<body>
  <nav>
    <a href="./index.html">Home</a>
    <a href="./survey.html">Survey</a>
    <a href="./places.html">Places</a>
    <a href="./foods.html">Foods</a>
  </nav>
  <main>
    <h1>travelSmart Survey</h1>
    <div class="actions">
      <button id="newSurveyBtn" class="cta-button" type="button">New Survey</button>
    </div>
    <form id="surveyForm" class="survey-form">
      <section>
        <h2>Travel Preferences</h2>
        <label>
          What type of attractions are you most interested in?
          <select name="attractions" required>
            <option value="">Select one…</option>
            <option>Museums</option>
            <option>Outdoor activities</option>
            <option>Historical sites</option>
            <option>Shopping</option>
            <option>Nightlife</option>
          </select>
        </label>
        <label>
          What kind of climate do you prefer for your trip?
          <select name="climate" required>
            <option value="">Select one…</option>
            <option>Warm</option>
            <option>Cold</option>
            <option>No preference</option>
          </select>
        </label>
        <label>
          How far are you willing to travel within New York State?
          <select name="distance" required>
            <option value="">Select one…</option>
            <option>Within 1 hour</option>
            <option>1–3 hours</option>
            <option>Anywhere in state</option>
          </select>
        </label>
      </section>
      <section>
        <h2>Food Preferences</h2>
        <label>
          Which types of cuisine do you most enjoy?
          <input type="text" name="cuisine" placeholder="e.g., Italian, Chinese, Mexican" required>
        </label>
        <label>
          Do you have any dietary restrictions or allergies?
          <input type="text" name="restrictions" placeholder="e.g., vegetarian, gluten-free, nuts" required>
        </label>
        <label>
          What is your preferred dining style?
          <select name="diningStyle" required>
            <option value="">Select one…</option>
            <option>Dine-in</option>
            <option>Takeout</option>
            <option>Delivery</option>
          </select>
        </label>
      </section>
      <section>
        <h2>Budget</h2>
        <label>
          What is your total budget for the trip?
          <select name="tripBudget" required>
            <option value="">Select one…</option>
            <option>Less than $100</option>
            <option>$100–$300</option>
            <option>$300–$600</option>
            <option>Over $600</option>
          </select>
        </label>
        <label>
          What is your typical price range for meals?
          <select name="mealBudget" required>
            <option value="">Select one…</option>
            <option>$</option>
            <option>$$</option>
            <option>$$$</option>
          </select>
        </label>
        <label>
          Should recommendations strictly match your budget, or are occasional splurges acceptable?
          <select name="strictBudget" required>
            <option value="">Select one…</option>
            <option>Strictly match budget</option>
            <option>Occasional splurges are okay</option>
          </select>
        </label>
      </section>
      <button type="submit" class="cta-button">Submit</button>
    </form>

    <div id="confirmation" style="display:none; color: green; margin-top: 1rem;">
      Thank you for submitting your preferences! Your recommendations will be ready soon.
    </div>

    <div id="latestSurvey" class="survey-results" style="display:none;">
      <h2>Your Most Recent Survey</h2>
      <div id="latestResults"></div>
    </div>

    <div class="survey-list">
      <h2>Previous Surveys</h2>
      <div id="previousSurveys"></div>
    </div>
  </main>
  <footer>
    <p>2025 travelSmart Project for PLC</p>
    <p>By: Adrian Wu, Kisn Mathema, Aaron Zhang, Andy Shao, Lamin Yabou</p>
  </footer>
  <script>
    // Utility to display survey data
    function renderSurvey(data) {
      return `<div class="survey-entry">
        <strong>Attractions:</strong> ${data.attractions}<br>
        <strong>Climate:</strong> ${data.climate}<br>
        <strong>Distance:</strong> ${data.distance}<br>
        <strong>Cuisine:</strong> ${data.cuisine}<br>
        <strong>Restrictions:</strong> ${data.restrictions}<br>
        <strong>Dining Style:</strong> ${data.diningStyle}<br>
        <strong>Trip Budget:</strong> ${data.tripBudget}<br>
        <strong>Meal Budget:</strong> ${data.mealBudget}<br>
        <strong>Budget Strictness:</strong> ${data.strictBudget}
        </div>`;
    }

    // Load previous surveys from localStorage
    function loadSurveys() {
      const saved = localStorage.getItem("travelSmartSurveys");
      return saved ? JSON.parse(saved) : [];
    }
    function saveSurvey(newSurvey) {
      const surveys = loadSurveys();
      surveys.push(newSurvey);
      localStorage.setItem("travelSmartSurveys", JSON.stringify(surveys));
    }
    function showSurveys() {
      const surveys = loadSurveys();
      const previousDiv = document.getElementById("previousSurveys");
      if (!surveys.length) {
        previousDiv.innerHTML = "<p>No previous surveys yet.</p>";
      } else {
        previousDiv.innerHTML = surveys.slice(0,-1).reverse().map(renderSurvey).join("");
      }
    }

    // Show latest survey results
    function showLatestSurvey() {
      const surveys = loadSurveys();
      if (surveys.length) {
        document.getElementById("latestSurvey").style.display = "block";
        document.getElementById("latestResults").innerHTML = renderSurvey(surveys[surveys.length-1]);
      } else {
        document.getElementById("latestSurvey").style.display = "none";
        document.getElementById("latestResults").innerHTML = "";
      }
    }

    // Reset to allow new survey
    function startNewSurvey() {
      document.getElementById('surveyForm').reset();
      document.getElementById('confirmation').style.display = 'none';
      document.getElementById('latestSurvey').style.display = 'none';
    }

    // Survey submit handler
    document.getElementById('surveyForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const formData = new FormData(event.target);
      const data = {};
      for (const [key, value] of formData.entries()) { data[key] = value; }
      saveSurvey(data);
      document.getElementById('confirmation').style.display = 'block';
      showLatestSurvey();
      showSurveys();
    });

    // Handle "New Survey" button
    document.getElementById('newSurveyBtn').addEventListener('click', startNewSurvey);

    // Show surveys on load
    showLatestSurvey();
    showSurveys();
  </script>
</body>
</html>
